
  .review-modal-apple {
    max-width: 480px;
    width: 92%;
    background: rgba(30,30,40,0.95);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border-radius: 28px;
    padding: 48px 40px;
    border: 1px solid rgba(255,255,255,0.12);
    box-shadow: 
      0 32px 80px rgba(0,0,0,0.35),
      inset 0 1px 0 rgba(255,255,255,0.08);
    animation: appleFade 0.6s cubic-bezier(0.22,1,0.36,1);
  }

  [data-theme="light"] .review-modal-apple {
    background: rgba(255,255,255,0.94);
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 
      0 32px 80px rgba(0,0,0,0.12),
      inset 0 1px 0 rgba(255,255,255,0.8);
  }

  @keyframes appleFade {
    from { opacity: 0; transform: translateY(30px) scale(0.96); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .review-header-apple {
    text-align: center;
    margin-bottom: 40px;
  }

  .review-header-apple h2 {
    font-size: 28px;
    font-weight: 600;
    letter-spacing: -0.5px;
    margin: 0 0 8px 0;
    color: #fff;
  }

  [data-theme="light"] .review-header-apple h2 {
    color: #000;
  }

  .review-header-apple p {
    font-size: 17px;
    color: #aaa;
    margin: 0;
    font-weight: 500;
  }

  [data-theme="light"] .review-header-apple p {
    color: #666;
  }

  /* ЗВЁЗДЫ — ЧИСТЫЙ APPLE */
  .review-stars-apple {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 32px 0 48px;
    padding: 20px 0;
  }

  .review-stars-apple i {
    font-size: 48px;
    color: #444;
    transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
    cursor: pointer;
  }

  [data-theme="light"] .review-stars-apple i {
    color: #ccc;
  }

  .review-stars-apple i:hover {
    transform: scale(1.15);
  }

  .review-stars-apple i.fas {
    color: #ff9f0a;
  }

  [data-theme="light"] .review-stars-apple i.fas {
    color: #ff9500;
  }

  .review-textarea-apple {
    width: 100%;
    min-height: 110px;
    padding: 16px 18px;
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 18px;
    color: #fff;
    font-size: 17px;
    font-family: -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
    resize: none;
    margin-bottom: 32px;
    transition: all 0.3s;
  }

  [data-theme="light"] .review-textarea-apple {
    background: rgba(0,0,0,0.05);
    border-color: rgba(0,0,0,0.18);
    color: #000;
  }

  .review-textarea-apple:focus {
    outline: none;
    border-color: #007aff;
    background: rgba(0,122,255,0.08);
    box-shadow: 0 0 0 4px rgba(0,122,255,0.15);
  }

  [data-theme="light"] .review-textarea-apple:focus {
    background: rgba(0,122,255,0.06);
    box-shadow: 0 0 0 4px rgba(0,122,255,0.12);
  }

  .review-textarea-apple::placeholder {
    color: #888;
  }

  /* КНОПКИ — ЧИСТЫЙ APPLE */
  .review-buttons-apple {
    display: flex;
    gap: 16px;
  }

  .review-btn-primary,
  .review-btn-secondary {
    flex: 1;
    padding: 16px;
    border-radius: 18px;
    font-size: 17px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
  }

  .review-btn-primary {
    background: #fff;
    color: #000;
    border: none;
  }

  [data-theme="light"] .review-btn-primary {
    background: #000;
    color: #fff;
  }

  .review-btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.2);
  }

  .review-btn-secondary {
    background: transparent;
    color: #aaa;
    border: 1px solid rgba(255,255,255,0.2);
  }

  [data-theme="light"] .review-btn-secondary {
    color: #666;
    border-color: rgba(0,0,0,0.18);
  }

  .review-btn-secondary:hover {
    background: rgba(255,255,255,0.08);
    color: #fff;
  }

  [data-theme="light"] .review-btn-secondary:hover {
    background: rgba(0,0,0,0.08);
    color: #000;
  }

  /* === КРАСИВАЯ ЦЕПОЧКА СТАТУСОВ — PILIGRIM 2025 === */
.order-chain-container {
  margin: 2rem auto;
  max-width: 1000px;
  padding: 0 1rem;
  animation: chainSlideDown 0.7s cubic-bezier(0.22, 1, 0.36, 1);
}

.order-chain-wrapper {
  background: rgba(20, 20, 30, 0.96);
  backdrop-filter: blur(32px);
  border: 1.5px solid rgba(255, 255, 255, 0.12);
  border-radius: 28px;
  padding: 2rem 2.5rem;
  box-shadow: 
    0 20px 60px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.08);
  text-align: center;
  position: relative;
  overflow: hidden;
}

[data-theme="light"] .order-chain-wrapper {
  background: rgba(255, 255, 255, 0.96);
  border: 1.5px solid rgba(0, 0, 0, 0.1);
  box-shadow: 
    0 20px 60px rgba(0, 0, 0, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.8);
}

.order-chain-wrapper::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; height: 4px;
  background: linear-gradient(90deg, #00d2ff, #00ff95, #00d2ff);
  background-size: 200% 100%;
  animation: shimmer 4s infinite linear;
}

.chain-title {
  font-size: 1.6rem;
  font-weight: 700;
  margin-bottom: 1.8rem;
  background: linear-gradient(90deg, #00d2ff, #00ff95);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.8rem;
}

[data-theme="light"] .chain-title {
  background: linear-gradient(90deg, #0066ff, #00cc77);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.chain-title i {
  font-size: 1.8rem;
}

.chain-steps {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 1.5rem;
  margin: 2rem 0;
  position: relative;
}

.chain-step {
  text-align: center;
  min-width: 90px;
  position: relative;
  flex: 1;
}

.chain-icon {
  width: 68px;
  height: 68px;
  margin: 0 auto 0.8rem;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.08);
  border: 4px solid rgba(255, 255, 255, 0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow: 0 0 20px rgba(0, 210, 255, 0.2);
}

[data-theme="light"] .chain-icon {
  background: rgba(0, 0, 0, 0.06);
  border-color: rgba(0, 0, 0, 0.15);
}

.chain-icon.active {
  border-color: #00ff95;
  background: rgba(0, 255, 149, 0.15);
  box-shadow: 0 0 40px rgba(0, 255, 149, 0.6);
  transform: scale(1.2);
}

.chain-icon.done {
  border-color: #888;
  background: rgba(255, 255, 255, 0.12);
}

.chain-icon img, .chain-icon canvas {
  width: 36px;
  height: 36px;
  filter: brightness(0) invert(1);
}

.chain-icon.active img,
.chain-icon.active canvas {
  filter: brightness(0) invert(0.8) sepia(1) hue-rotate(90deg) saturate(5);
}

.chain-label {
  font-size: 0.9rem;
  color: #aaa;
  font-weight: 500;
  transition: color 0.4s;
}

.chain-step.active .chain-label,
.chain-step.done .chain-label {
  color: #fff;
  font-weight: 600;
}

.chain-connector {
  position: absolute;
  top: 34px;
  left: 80px;
  right: -40px;
  height: 4px;
  background: rgba(255, 255, 255, 0.15);
  border-radius: 2px;
  z-index: -1;
}

.chain-connector.active {
  background: linear-gradient(90deg, #00d2ff, #00ff95);
  box-shadow: 0 0 15px rgba(0, 255, 149, 0.6);
}

.chain-message {
  margin-top: 1rem;
  font-size: 1.1rem;
  color: #00ff95;
  font-weight: 600;
}

.chain-message.cancelled {
  color: #ff6b6b;
}

.chain-cancel-btn {
  margin-top: 1.2rem;
  padding: 0.8rem 1.8rem;
  background: #ff4444;
  color: white;
  border: none;
  border-radius: 16px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(255, 68, 68, 0.3);
  transition: all 0.3s;
}

.chain-cancel-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 35px rgba(255, 68, 68, 0.4);
}

@keyframes chainSlideDown {
  from { opacity: 0; transform: translateY(-30px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

.chain-loading {
  color: #00d2ff;
  font-size: 1.1rem;
}

.chain-loading i {
  animation: spin 1.5s linear infinite;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
/* Поддержка светлой темы */
[data-theme="light"] #orderChain > div {
  background: rgba(255,255,255,0.95) !important;
  border: 1.5px solid rgba(0,0,0,0.1) !important;
  box-shadow: 0 20px 60px rgba(0,0,0,0.12) !important;
}
[data-theme="light"] #orderChain h3 { 
  background: linear-gradient(90deg,#0066ff,#00cc77); 
  -webkit-background-clip:text; -webkit-text-fill-color:transparent; 
}
[data-theme="light"] #chainMessage { color:#00aa77; }

/* Анимация полоски */
@keyframes shimmer { 0%{background-position:-200% 0} 100%{background-position:200% 0} }

/* Стили для активных/выполненных шагов (применяются JS-ом) */
.chain-step-active .chain-canvas-wrapper {
  border: 5px solid #00ff95 !important;
  box-shadow: 0 0 0 15px rgba(0,255,149,0.3), 0 0 40px rgba(0,255,149,0.5) !important;
  transform: scale(1.25);
}
.chain-step-done .chain-canvas-wrapper {
  border-color: #666 !important;
}
.chain-connector-active {
  background: linear-gradient(90deg, #00d2ff, #00ff95) !important;
  height: 6px !important;
  box-shadow: 0 0 20px rgba(0,255,149,0.6);
}


    /* ==================================================
   АРХИВ ЗАКАЗОВ — PILIGRIM 2025 (полностью рабочая версия)
   Тёмная + светлая тема, без багов, всё в одном месте
================================================== */
.clickable-order {
    cursor: pointer;
    transition: all 0.3s;
}
.clickable-order:hover {
    background: rgba(255,255,255,0.1) !important;
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.25);
}
.chain-toggle-btn {
    position: absolute;
    top: 20px; right: 20px;
    width: 40px; height: 40px;
    background: rgba(255,255,255,0.1);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    font-size: 1.4rem;
    z-index: 10;
    transition: all 0.3s;
}
.chain-toggle-btn:hover { background: rgba(255,255,255,0.2); transform: rotate(180deg); }
[data-theme="light"] .chain-toggle-btn { background: rgba(0,0,0,0.1); }
[data-theme="light"] .chain-toggle-btn:hover { background: rgba(0,0,0,0.2); }
.archive-modal-beauty {
  position: relative;
  max-width: 920px;
  width: 92%;
  max-height: 90vh;
  background: rgba(20,20,30,0.98);
  backdrop-filter: blur(32px);
  border: 1.5px solid rgba(255,255,255,0.12);
  border-radius: 32px;
  overflow: hidden;
  box-shadow: 0 32px 100px rgba(0,0,0,0.7), inset 0 1px 0 rgba(255,255,255,0.08);
  animation: modalAppear 0.5s cubic-bezier(0.22,1,0.36,1);
}
[data-theme="light"] .archive-modal-beauty {
  background: rgba(255,255,255,0.96);
  border-color: rgba(0,0,0,0.1);
  box-shadow: 0 32px 100px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.8);
}

@keyframes modalAppear {
  from { opacity: 0; transform: scale(0.94) translateY(30px); }
  to   { opacity: 1; transform: scale(1) translateY(0); }
}

/* Шапка модалки */
.archive-header {
  text-align: center;
  padding: 2.5rem 2rem 2rem;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}
[data-theme="light"] .archive-header { border-bottom-color: rgba(0,0,0,0.1); }

.archive-icon {
  width: 90px; height: 90px;
  margin: 0 auto 1.2rem;
  background: rgba(255,255,255,0.1);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 2.8rem;
}
[data-theme="light"] .archive-icon { background: rgba(0,0,0,0.08); }
.archive-icon i { color: white; }
[data-theme="light"] .archive-icon i { color: black; }

.archive-header h2 {
  font-size: 2.4rem;
  font-weight: 700;
  margin: 0 0 0.5rem;
}
.archive-header p {
  color: #aaa;
  font-size: 1.1rem;
}
[data-theme="light"] .archive-header p { color: #666; }

/* Табы */
.orders-tabs {
  display: flex;
  gap: 1rem;
  margin: 1.5rem 1.5rem 0;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(255,255,255,0.1);
}
[data-theme="light"] .orders-tabs { border-bottom-color: rgba(0,0,0,0.1); }

.tab-btn {
  background: none;
  border: none;
  color: #aaa;
  font-size: 1.1rem;
  font-weight: 600;
  padding: 0.5rem 0;
  cursor: pointer;
  position: relative;
  transition: color 0.3s;
}
.tab-btn:hover { color: #fff; }
[data-theme="light"] .tab-btn:hover { color: #000; }

.tab-btn.active {
  color: white;
}
[data-theme="light"] .tab-btn.active { color: black; }

.tab-btn.active::after {
  content: '';
  position: absolute;
  bottom: -0.5rem; left: 0; right: 0;
  height: 3px;
  background: linear-gradient(90deg, #00d2ff, #00ff95);
  border-radius: 2px;
}
[data-theme="light"] .tab-btn.active::after {
  background: linear-gradient(90deg, #0066ff, #00cc77);
}

/* Поиск */
.orders-search {
  margin: 1.5rem;
  position: relative;
}
.orders-search i {
  position: absolute;
  left: 1.2rem;
  top: 50%;
  transform: translateY(-50%);
  color: #888;
  pointer-events: none;
}
#orderSearch {
  width: 100%;
  padding: 1rem 1rem 1rem 3rem;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 16px;
  color: white;
  font-size: 1rem;
  transition: all 0.3s;
}
#orderSearch:focus {
  outline: none;
  border-color: #00d2ff;
  box-shadow: 0 0 0 3px rgba(0,210,255,0.2);
}
[data-theme="light"] #orderSearch {
  background: rgba(0,0,0,0.05);
  border-color: rgba(0,0,0,0.15);
  color: black;
}
[data-theme="light"] #orderSearch:focus {
  border-color: #0066ff;
  box-shadow: 0 0 0 3px rgba(0,102,255,0.15);
}

/* Список заказов */
.orders-list {
  padding: 1.5rem;
  max-height: 65vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* Скроллбар */
.orders-list::-webkit-scrollbar { width: 8px; }
.orders-list::-webkit-scrollbar-track { background: transparent; }
.orders-list::-webkit-scrollbar-thumb {
  background: rgba(255,255,255,0.2);
  border-radius: 4px;
}
[data-theme="light"] .orders-list::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
}

/* Карточка заказа */
.orders-list .cart-item {
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 20px;
  padding: 1.8rem;
  transition: all 0.3s;
}
[data-theme="light"] .orders-list .cart-item {
  background: rgba(0,0,0,0.04);
  border-color: rgba(0,0,0,0.1);
}
.orders-list .cart-item:hover {
  background: rgba(255,255,255,0.1);
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(0,0,0,0.2);
}
[data-theme="light"] .orders-list .cart-item:hover {
  background: rgba(0,0,0,0.06);
}

/* Мини-цепочка статусов внутри карточки */
.mini-status-chain {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  margin: 1.5rem 0;
  padding: 1rem;
  background: rgba(0,255,149,0.05);
  border: 1px solid rgba(0,255,149,0.2);
  border-radius: 16px;
}
.mini-step { text-align: center; flex: 1; }
.mini-dot {
  width: 12px; height: 12px;
  background: #444;
  border-radius: 50%;
  margin: 0 auto 0.5rem;
  transition: all 0.4s;
}
.mini-step.active .mini-dot {
  background: #00ff95;
  box-shadow: 0 0 20px rgba(0,255,149,0.6);
}
.mini-label {
  font-size: 0.85rem;
  color: #888;
}
.mini-step.active .mini-label {
  color: #00ff95;
  font-weight: 600;
}
.mini-connector {
  height: 3px;
  background: #444;
  flex: 1;
  margin: 0 0.5rem;
  border-radius: 2px;
}
.mini-connector.active {
  background: #00ff95;
  box-shadow: 0 0 15px rgba(0,255,149,0.5);
}

/* Кнопка "Повторить" */
.orders-list .btn-primary {
  background: white;
  color: black;
  padding: 0.5rem 1rem;
  border-radius: 12px;
  font-weight: 600;
  font-size: 0.85rem;
  white-space: nowrap;
  transition: all 0.3s;
}
[data-theme="light"] .orders-list .btn-primary {
  background: black;
  color: white;
}
.orders-list .btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}

/* Пустые состояния */
.archive-empty {
  text-align: center;
  padding: 3rem 1rem;
  color: #888;
}
[data-theme="light"] .archive-empty { color: #666; }
.archive-empty i {
  font-size: 3.5rem;
  opacity: 0.3;
  margin-bottom: 1rem;
  display: block;
}

/* Кнопка "Загрузить ещё" */
#loadMoreContainer {
  text-align: center;
  padding: 2rem 0;
}
#loadMoreBtn {
  padding: 0.9rem 2rem;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 16px;
  color: white;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s;
}
#loadMoreBtn:hover {
  background: rgba(255,255,255,0.15);
  transform: translateY(-2px);
}
[data-theme="light"] #loadMoreBtn {
  background: rgba(0,0,0,0.06);
  border-color: rgba(0,0,0,0.15);
  color: black;
}
[data-theme="light"] #loadMoreBtn:hover {
  background: rgba(0,0,0,0.1);
}

/* Адаптив */
@media (max-width: 768px) {
  .archive-modal-beauty { width: 95%; border-radius: 28px; }
  .archive-header { padding: 2rem 1.5rem 1.5rem; }
  .archive-header h2 { font-size: 2rem; }
  .orders-list { padding: 1.2rem; gap: 1.2rem; }
  .orders-tabs { margin: 1.2rem 1.2rem 0; }
  .orders-search { margin: 1.2rem; }
}


  .checkout-modal-beauty {
    position: relative;
    max-width: 480px;
    width: 90%;
    background: rgba(2, 2, 2, 0.98);
    backdrop-filter: blur(32px);
    border: 1.5px solid rgba(255,255,255,0.12);
    border-radius: 32px;
    padding: 3rem 2.5rem;
    box-shadow: 
      0 32px 80px rgba(48, 48, 48, 0.6),
      inset 0 1px 0 rgba(255,255,255,0.08);
    animation: modalAppear 0.5s cubic-bezier(0.22,1,0.36,1);
  }

  [data-theme="light"] .checkout-modal-beauty {
    background: rgba(255,255,255,0.96);
    border: 1.5px solid rgba(0,0,0,0.1);
    box-shadow: 
      0 32px 80px rgba(0,0,0,0.15),
      inset 0 1px 0 rgba(255,255,255,0.8);
  }

  @keyframes modalAppear {
    from { opacity:0; transform:scale(0.92) translateY(30px); }
    to { opacity:1; transform:scale(1) translateY(0); }
  }

  .checkout-header {
    text-align: center;
    margin-bottom: 2rem;
  }
  .checkout-icon {
    width: 80px; height: 80px;
    margin: 0 auto 1rem;
    background: rgba(255,255,255,0.1);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.4rem;
  }
  [data-theme="light"] .checkout-icon {
    background: rgba(0,0,0,0.08);
  }
  .checkout-icon i { color: white; }
  [data-theme="light"] .checkout-icon i { color: black; }

  .checkout-header h2 {
    font-size: 2.4rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
  }
  .checkout-header p {
    color: #aaa;
    font-size: 1.1rem;
  }
  [data-theme="light"] .checkout-header p { color: #666; }

  .checkout-summary {
    background: rgba(255,255,255,0.06);
    border-radius: 20px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    border: 1px solid rgba(255,255,255,0.08);
  }
  [data-theme="light"] .checkout-summary {
    background: rgba(0,0,0,0.04);
    border: 1px solid rgba(0,0,0,0.08);
  }

  .summary-item {
    display: flex;
    justify-content: space-between;
    
    font-size: 1.1rem;
    margin-bottom: 0.8rem;
  }
  .summary-item.total {
    font-size: 1.7rem;
    font-weight: 700;
    padding-top: 1.2rem;
    border-top: 1px solid rgba(255,255,255,0.15);
    margin-top: 0.5rem;
  }
  [data-theme="light"] .summary-item.total { border-top-color: rgba(0,0,0,0.12); }

  .input-group {
    position: relative;
    margin-bottom: 1.5rem;
  }
  .input-group i {
    position: absolute;
    left: 1.2rem;
    top: 50%;
    transform: translateY(-50%);
    color: #888;
    font-size: 1.2rem;
    z-index: 2;
  }
  [data-theme="light"] .input-group i { color: #666; }

  .input-group input {
    width: 100%;
    padding: 1.3rem 1.2rem 1.3rem 3.2rem;
    background: rgba(255,255,255,0.08);
    border: 1.5px solid rgba(255,255,255,0.15);
    border-radius: 18px;
    color: white;
    font-size: 1.1rem;
    transition: all 0.3s;
  }
  [data-theme="light"] .input-group input {
    background: rgba(0,0,0,0.06);
    border-color: rgba(0,0,0,0.15);
    color: black;
  }

  .input-group input:focus {
    outline: none;
    border-color: white;
    background: rgba(255,255,255,0.14);
    box-shadow: 0 0 0 4px rgba(255,255,255,0.12);
  }
  [data-theme="light"] .input-group input:focus {
    border-color: black;
    background: rgba(0,0,0,0.08);
    box-shadow: 0 0 0 4px rgba(0,0,0,0.1);
  }

  .input-group input::placeholder { color: #777; }
  [data-theme="light"] .input-group input::placeholder { color: #999; }

  .phone-premium {
    background: rgba(255,255,255,0.08);
    border: 1.5px solid rgba(255,255,255,0.15);
    border-radius: 20px;
    padding: 1.6rem;
    margin: 1.8rem 0;
    text-align: center;
  }
  [data-theme="light"] .phone-premium {
    background: rgba(0,0,0,0.06);
    border-color: rgba(0,0,0,0.15);
  }

  .phone-premium-inner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    font-size: 1.1rem;
  }
  .phone-premium i { font-size: 1.6rem; color: white; }
  [data-theme="light"] .phone-premium i { color: black; }

  .phone-number-big {
    font-weight: 700;
    font-size: 1.5rem;
    margin-top: 0.4rem;
    letter-spacing: 1px;
  }
/* Базовый стиль для всех строк */
.summary-row {
  display: flex;
  justify-content: space-between;
  align-items: center;           /* Это главное! */
  font-size: 1.15rem;
  margin-bottom: 0.9rem;
  line-height: 1.4;
}

/* Строка "К оплате" — самая важная */
.summary-row.total {
  align-items: center !important;     /* принудительно по центру */
  font-size: 1.85rem !important;      /* большой жирный текст */
  font-weight: 800;
  letter-spacing: -0.03em;
  padding-top: 1.4rem;
  margin-top: 1.2rem;
  border-top: 1.5px solid rgba(255,255,255,0.18);
  min-height: 58px;                   /* фиксируем высоту строки */
}

/* Чтобы "К оплате:" был чуть меньше и не тянул строку вверх */
.summary-row.total span {
  font-size: 1.32rem;                 /* меньше, чем сумма */
  font-weight: 600;
  opacity: 0.88;
  margin-right: 1rem;
}

/* Светлая тема */
[data-theme="light"] .summary-row.total {
  border-top-color: rgba(0,0,0,0.14);
}
[data-theme="light"] .summary-row.total span {
  opacity: 0.82;
}
  .confirm-beauty-btn {
    width: 100%;
    padding: 1.5rem;
    background: white;
    color: black;
    border: none;
    border-radius: 20px;
    font-size: 1.3rem;
    font-weight: 700;
    cursor: pointer;
    margin-top: 1rem;
    transition: all 0.4s;
    position: relative;
    overflow: hidden;
  }
  [data-theme="light"] .confirm-beauty-btn {
    background: black;
    color: white;
  }

  .confirm-beauty-btn:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
  }
  [data-theme="light"] .confirm-beauty-btn:hover {
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  }

  .confirm-beauty-btn:active { transform: translateY(-1px); }

  .checkout-footer {
    text-align: center;
    margin-top: 2rem;
    color: #666;
    font-size: 0.9rem;
  }
  .checkout-footer a {
    color: inherit;
    text-decoration: underline;
  }

  @media (max-width: 480px) {
    .checkout-modal-beauty { padding: 2.5rem 1.8rem; border-radius: 28px; }
    .checkout-header h2 { font-size: 2rem; }
    .phone-number-big { font-size: 1.35rem; }
  }

@media (max-width: 1025px) {
  #checkoutModal {
    position: fixed !important;
    inset: 0;
    background: rgba(0,0,0,0.75);
    backdrop-filter: blur(32px);
    -webkit-backdrop-filter: blur(32px);
    display: flex;
    align-items: flex-end;           /* ← прижимаем к низу */
    justify-content: center;
    padding: 0;
    z-index: 2147483647 !important;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.65s cubic-bezier(0.22,1,0.36,1),
                visibility 0s linear 0.65s;
  }

  #checkoutModal.show {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.65s cubic-bezier(0.22,1,0.36,1);
  }

  /* ───── САМА ШТОРКА ───── */
  .checkout-modal-beauty {
    width: 100%;
    max-width: none !important;

    /* ВАЖНО: высота от самого низа экрана до самого верха + safe-area */
    height: calc(100dvh - env(safe-area-inset-bottom));
    max-height: calc(100dvh - env(safe-area-inset-bottom));

    background: rgba(2,2,2,0.98);
    backdrop-filter: blur(40px);
    -webkit-backdrop-filter: blur(40px);
    border-radius: 32px 32px 0 0;
    
    /* Отступ сверху под чёлку/Dynamic Island */
    padding-top: env(safe-area-inset-top);
    padding-left: 20px;
    padding-right: 20px;
    padding-bottom: 40px;           /* + место под кнопку и Home Indicator */

    box-sizing: border-box;
    box-shadow: 0 -20px 80px rgba(0,0,0,0.6);

    transform: translateY(100%);
    transition: transform 0.65s cubic-bezier(0.22,1,0.36,1);

    overflow-y: auto;
    -webkit-overflow-scrolling: touch;

    display: flex;
    flex-direction: column;
  }

  [data-theme="light"] .checkout-modal-beauty {
    background: rgba(255,255,255,0.97);
    border: 1.5px solid rgba(0,0,0,0.08);
    box-shadow: 0 -20px 80px rgba(0,0,0,0.25);
  }

  #checkoutModal.show .checkout-modal-beauty {
    transform: translateY(0);
  }

  /* Граббер */
  .checkout-modal-beauty::before {
    content: "";
    width: 40px;
    height: 5px;
    background: rgba(255,255,255,0.35);
    border-radius: 3px;
    margin: 10px auto 20px;
    flex-shrink: 0;
  }
  [data-theme="light"] .checkout-modal-beauty::before {
    background: rgba(0,0,0,0.25);
  }

  /* Крестик — всегда в безопасной зоне */
  #closeCheckout {
    position: absolute;
    top: calc(env(safe-area-inset-top) + 12px);
    right: 16px;
    width: 44px; height: 44px;
    background: rgba(255,255,255,0.2);
    color: white;
    border-radius: 50%;
    font-size: 1.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    backdrop-filter: blur(12px);
  }
  [data-theme="light"] #closeCheckout {
    background: rgba(0,0,0,0.12);
    color: #000;
  }

  /* Скрываем скроллбар */
  .checkout-modal-beauty::-webkit-scrollbar { display: none; }
  .checkout-modal-beauty { -ms-overflow-style: none; scrollbar-width: none; }
}

/* ───── МОБИЛЬНЫЙ АДАПТИВНЫЙ АЛЕРТ (≤1026px) ───── */
@media (max-width: 1026px) {
  /* Скрываем старый ПК-тост на мобилке */
  #toast-container,
  .toast {
    display: none !important;
  }

  #mobileAlert {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.65);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2147483647 !important; /* выше всех модалок */
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.45s cubic-bezier(0.22,1,0.36,1), visibility 0s linear 0.45s;
  }

  #mobileAlert.show {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.45s cubic-bezier(0.22,1,0.36,1);
  }

  .mobile-alert-content {
    width: 88%;
    max-width: 360px;
    background: rgba(28,28,30,0.96);
    backdrop-filter: blur(32px);
    border-radius: 24px;
    padding: 24px 20px;
    text-align: center;
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    border: 1px solid rgba(255,255,255,0.08);
    transform: scale(0.9);
    transition: transform 0.45s cubic-bezier(0.22,1,0.36,1);
  }

  #mobileAlert.show .mobile-alert-content {
    transform: scale(1);
  }

  [data-theme="light"] .mobile-alert-content {
    background: rgba(255,255,255,0.96);
    border: 1px solid rgba(0,0,0,0.1);
    box-shadow: 0 20px 50px rgba(0,0,0,0.22);
  }

  .mobile-alert-icon {
    font-size: 3.2rem;
    margin-bottom: 16px;
    opacity: 0.9;
  }

  .mobile-alert-message {
    font-size: 1.15rem;
    font-weight: 600;
    line-height: 1.45;
    margin-bottom: 24px;
    color: var(--text-primary, #fff);
  }

  .mobile-alert-btn {
    width: 100%;
    padding: 14px;
    background: #00ff95;
    color: #000;
    border: none;
    border-radius: 16px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
  }

  [data-theme="light"] .mobile-alert-btn {
    background: #000;
    color: #fff;
  }
}

/* На ПК — прячем мобильный алерт */
@media (min-width: 1027px) {
  #mobileAlert { display: none !important; }
}
    /* ==================================================
   ОТЗЫВЫ + ЦЕПОЧКА СТАТУСОВ — PILIGRIM 2025
   Полностью рабочая версия (тёмная + светлая тема)
   Вставляй один раз и забудь про баги
================================================== */


#cancelOrderModal {
  font-family: 'Inter', system-ui, sans-serif;
}

/* Общий контейнер */
.cancel-modal-inner {
  background: rgba(15,15,30,0.98);
  border-radius: 28px;
  max-width: 460px;
  width: 100%;
  padding: 2rem 2rem 2.5rem;
  box-shadow: 0 40px 100px rgba(0,0,0,0.8);
  border: 1px solid rgba(255,255,255,0.09);
  text-align: center;
  position: relative;
  animation: modalPop 0.45s cubic-bezier(0.22,0.61,0.36,1);
}

/* Граббер сверху */
.ios-grabber {
  position: absolute;
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
  width: 44px;
  height: 5.5px;
  background: rgba(255,255,255,0.3);
  border-radius: 3px;
}

/* Иконка ошибки */
.cancel-modal-icon {
  width: 84px;
  height: 84px;
  margin: 0 auto 1.5rem;
  background: #ff4444;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
}
.cancel-modal-icon i {
  font-size: 3rem;
  color: white;
}

/* Заголовок и текст */
.cancel-modal-title {
  margin: 0 0 1rem;
  font-size: 1.9rem;
  font-weight: 800;
  color: #fff;
}
.cancel-modal-text {
  margin: 0 0 2rem;
  color: #ccc;
  font-size: 1.1rem;
  line-height: 1.6;
}
.cancel-modal-text strong { color: #fff; }

/* Поле ввода причины */
.cancel-modal-textarea {
  width: 100%;
  height: 110px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 16px;
  padding: 1rem;
  color: #fff;
  font-size: 1rem;
  resize: none;
  margin-bottom: 1.5rem;
  font-family: inherit;
}
.cancel-modal-textarea::placeholder { color: rgba(255,255,255,0.5); }

/* Кнопки */
.cancel-modal-buttons {
  display: flex;
  gap: 1rem;
}
.cancel-btn-danger,
.cancel-btn-secondary {
  flex: 1;
  padding: 1.1rem;
  border-radius: 20px;
  font-weight: 600;
  font-size: 1.1rem;
  cursor: pointer;
  border: none;
  transition: all 0.3s ease;
}
.cancel-btn-danger {
  background: #ff4444;
  color: white;
}
.cancel-btn-danger:hover { background: #ff3333; transform: translateY(-2px); }
.cancel-btn-secondary {
  background: rgba(255,255,255,0.12);
  color: #fff;
}
.cancel-btn-secondary:hover {
  background: rgba(255,255,255,0.2);
}

/* === СВЕТЛАЯ ТЕМА === */
html[data-theme="light"] #cancelOrderModal {
  background: rgba(0,0,0,0.7);
}

html[data-theme="light"] .cancel-modal-inner {
  background: rgba(255,255,255,0.98);
  border: 1px solid rgba(0,0,0,0.08);
  box-shadow: 0 40px 100px rgba(0,0,0,0.18);
}

html[data-theme="light"] .ios-grabber {
  background: rgba(0,0,0,0.25);
}

html[data-theme="light"] .cancel-modal-title {
  color: #111;
}

html[data-theme="light"] .cancel-modal-text {
  color: #555;
}
html[data-theme="light"] .cancel-modal-text strong {
  color: #000;
}

html[data-theme="light"] .cancel-modal-textarea {
  background: rgba(0,0,0,0.06);
  border: 1px solid rgba(0,0,0,0.15);
  color: #111;
}
html[data-theme="light"] .cancel-modal-textarea::placeholder {
  color: rgba(0,0,0,0.5);
}

html[data-theme="light"] .cancel-btn-secondary {
  background: rgba(0,0,0,0.08);
  color: #111;
}
html[data-theme="light"] .cancel-btn-secondary:hover {
  background: rgba(0,0,0,0.14);
}

@keyframes modalPop {
  from { transform: scale(0.85); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}

.review-modal-apple {
  max-width: 480px;
  width: 92%;
  background: rgba(30,30,40,0.95);
  backdrop-filter: blur(40px);
  -webkit-backdrop-filter: blur(40px);
  border-radius: 28px;
  padding: 48px 40px;
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 32px 80px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  animation: appleFade 0.6s cubic-bezier(0.22,1,0.36,1);
}
[data-theme="light"] .review-modal-apple {
  background: rgba(255,255,255,0.96);
  border-color: rgba(0,0,0,0.1);
  box-shadow: 0 32px 80px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.8);
}

@keyframes appleFade {
  from { opacity: 0; transform: translateY(30px) scale(0.96); }
  to   { opacity: 1; transform: translateY(0) scale(1); }
}

/* Заголовок отзыва */
.review-header-apple h2 { font-size: 28px; font-weight: 600; letter-spacing: -0.5px; margin: 0 0 8px; color: #fff; }
[data-theme="light"] .review-header-apple h2 { color: #000; }
.review-header-apple p { font-size: 17px; color: #aaa; font-weight: 500; }
[data-theme="light"] .review-header-apple p { color: #666; }

/* Звёзды Apple-style */
.review-stars-apple {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin: 32px 0 48px;
  padding: 20px 0;
}
.review-stars-apple i {
  font-size: 48px;
  color: #444;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.2,0.8,0.2,1);
}
.review-stars-apple i:hover { transform: scale(1.15); }
.review-stars-apple i.fas { color: #ff9f0a; }
[data-theme="light"] .review-stars-apple i { color: #ccc; }
[data-theme="light"] .review-stars-apple i.fas { color: #ff9500; }

/* Текстовое поле */
.review-textarea-apple {
  width: 100%;
  min-height: 110px;
  padding: 16px 18px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 18px;
  color: #fff;
  font-size: 17px;
  font-family: -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;
  resize: none;
  margin-bottom: 32px;
  transition: all 0.3s;
}
[data-theme="light"] .review-textarea-apple {
  background: rgba(0,0,0,0.05);
  border-color: rgba(0,0,0,0.18);
  color: #000;
}
.review-textarea-apple:focus {
  outline: none;
  border-color: #007aff;
  background: rgba(0,122,255,0.08);
  box-shadow: 0 0 0 4px rgba(0,122,255,0.15);
}
[data-theme="light"] .review-textarea-apple:focus {
  background: rgba(0,122,255,0.06);
  box-shadow: 0 0 0 4px rgba(0,122,255,0.12);
}
.review-textarea-apple::placeholder { color: #888; }

/* Кнопки */
.review-buttons-apple { display: flex; gap: 16px; }
.review-btn-primary, .review-btn-secondary {
  flex: 1;
  padding: 16px;
  border-radius: 18px;
  font-size: 17px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.2,0.8,0.2,1);
}
.review-btn-primary {
  background: #fff;
  color: #000;
  border: none;
}
[data-theme="light"] .review-btn-primary { background: #000; color: #fff; }
.review-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 12px 30px rgba(0,0,0,0.2); }

.review-btn-secondary {
  background: transparent;
  color: #aaa;
  border: 1px solid rgba(255,255,255,0.2);
}
[data-theme="light"] .review-btn-secondary { color: #666; border-color: rgba(0,0,0,0.18); }
.review-btn-secondary:hover {
  background: rgba(255,255,255,0.08);
  color: #fff;
}
[data-theme="light"] .review-btn-secondary:hover {
  background: rgba(0,0,0,0.08);
  color: #000;
}

/* ==================================================
   ЦЕПОЧКА СТАТУСОВ ЗАКАЗА
================================================== */
.order-chain-container {
  margin: 2rem auto;
  max-width: 1000px;
  padding: 0 1rem;
  animation: chainSlideDown 0.7s cubic-bezier(0.22,1,0.36,1);
}
.order-chain-wrapper {
  background: rgba(20,20,30,0.96);
  backdrop-filter: blur(32px);
  border: 1.5px solid rgba(255,255,255,0.12);
  border-radius: 28px;
  padding: 2rem 2.5rem;
  box-shadow: 0 20px 60px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.08);
  text-align: center;
  position: relative;
  overflow: hidden;
}
[data-theme="light"] .order-chain-wrapper {
  background: rgba(255,255,255,0.96);
  border-color: rgba(0,0,0,0.1);
  box-shadow: 0 20px 60px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.8);
}

.order-chain-wrapper::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 4px;
  background: linear-gradient(90deg, #00d2ff, #00ff95, #00d2ff);
  background-size: 200% 100%;
  animation: shimmer 4s infinite linear;
}

.chain-title {
  font-size: 1.6rem;
  font-weight: 700;
  margin-bottom: 1.8rem;
  background: linear-gradient(90deg, #00d2ff, #00ff95);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.8rem;
}
[data-theme="light"] .chain-title {
  background: linear-gradient(90deg, #0066ff, #00cc77);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.chain-steps {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 1.5rem;
  margin: 2rem 0;
  position: relative;
}
.chain-step { text-align: center; flex: 1; min-width: 90px; position: relative; }

.chain-icon {
  width: 68px; height: 68px;
  margin: 0 auto 0.8rem;
  border-radius: 50%;
  background: rgba(255,255,255,0.08);
  border: 4px solid rgba(255,255,255,0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.5s cubic-bezier(0.34,1.56,0.64,1);
  box-shadow: 0 0 20px rgba(0,210,255,0.2);
}
[data-theme="light"] .chain-icon {
  background: rgba(0,0,0,0.06);
  border-color: rgba(0,0,0,0.15);
}
.chain-icon.active {
  border-color: #00ff95;
  background: rgba(0,255,149,0.15);
  box-shadow: 0 0 40px rgba(0,255,149,0.6);
  transform: scale(1.2);
}
.chain-icon.done { border-color: #888; background: rgba(255,255,255,0.12); }

.chain-icon img, .chain-icon canvas { width: 36px; height: 36px; filter: brightness(0) invert(1); }
.chain-icon.active img, .chain-icon.active canvas {
  filter: brightness(0) invert(0.8) sepia(1) hue-rotate(90deg) saturate(5);
}

.chain-label {
  font-size: 0.9rem;
  color: #aaa;
  font-weight: 500;
  transition: color 0.4s;
}
.chain-step.active .chain-label,
.chain-step.done .chain-label { color: #fff; font-weight: 600; }

.chain-connector {
  position: absolute;
  top: 34px;
  left: 80px;
  right: -40px;
  height: 4px;
  background: rgba(255,255,255,0.15);
  border-radius: 2px;
  z-index: -1;
}
.chain-connector.active {
  background: linear-gradient(90deg, #00d2ff, #00ff95);
  box-shadow: 0 0 15px rgba(0,255,149,0.6);
}

.chain-message { margin-top: 1rem; font-size: 1.1rem; color: #00ff95; font-weight: 600; }
.chain-message.cancelled { color: #ff6b6b; }

.chain-cancel-btn {
  margin-top: 1.2rem;
  padding: 0.8rem 1.8rem;
  background: #ff4444;
  color: white;
  border: none;
  border-radius: 16px;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(255,68,68,0.3);
  transition: all 0.3s;
}
.chain-cancel-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 35px rgba(255,68,68,0.4); }

@keyframes chainSlideDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
.chain-loading i { animation: spin 1.5s linear infinite; }
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* Совместимость со старым JS (если используешь классы active/done через JS) */
.chain-step-active  .chain-icon { border-color: #00ff95 !important; background: rgba(0,255,149,0.15) !important; box-shadow: 0 0 40px rgba(0,255,149,0.6) !important; transform: scale(1.2) !important; }
.chain-connector-active { background: linear-gradient(90deg,#00d2ff,#00ff95) !important; box-shadow: 0 0 15px rgba(0,255,149,0.6) !important; }

/* Светлая тема — фикс старого селектора */
[data-theme="light"] #chainMessage { color: #00aa77; }


    /* === СТИЛИ ЛАМПОЧКИ — ТЕПЕРЬ ВСЕГДА С ТОБОЙ === */
    .theme-toggle-hanging {
      position: fixed;
      top: 90px;
      right: 6%;
      z-index: 999;
      pointer-events: auto;
      transform: translateY(-50%);
    }
    header.scrolled ~ .theme-toggle-hanging,
    header.scrolled + .theme-toggle-hanging {
      top: 76px;
    }
    .theme-toggle-input { display: none; }
    .theme-toggle-label {
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
      transition: transform 0.3s cubic-bezier(0.34,1.56,0.64,1);
    }
    .theme-toggle-label:hover { transform: translateY(-4px); }
    .theme-toggle-label:active { transform: translateY(6px); }

    .rope.top {
      width: 2px;
      height: 110px;
      background: linear-gradient(to bottom, rgba(255,255,255,0.15), rgba(255,255,255,0.4), rgba(255,255,255,0.15));
      box-shadow: 0 0 8px rgba(255,255,255,0.25);
      position: relative;
      transition: all 1.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    [data-theme="light"] .rope.top {
      background: linear-gradient(to bottom, rgba(0,0,0,0.08), rgba(0,0,0,0.22), rgba(0,0,0,0.08));
      box-shadow: 0 0 6px rgba(0,0,0,0.12);
    }
    .rope.top::before {
      content: '';
      position: absolute;
      top: 0; left: -4px; right: -4px; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      border-radius: 2px;
      animation: rope-shine 3s infinite ease-in-out;
    }
    [data-theme="light"] .rope.top::before {
      background: linear-gradient(90deg, transparent, rgba(0,0,0,0.15), transparent);
    }
    @keyframes rope-shine {
      0%,100% { opacity: 0.2; }
      50% { opacity: 0.7; }
    }

    .bulb {
      width: 38px; height: 38px;
      border-radius: 50%;
      background: radial-gradient(circle at 28% 28%, #fffbe6, #ffd700);
      border: 1.5px solid rgba(255,215,0,0.7);
      position: relative;
      box-shadow: 0 0 24px rgba(255,215,0,0.5), inset 0 0 12px rgba(255,255,255,0.7), 0 6px 12px rgba(0,0,0,0.3);
      transition: all 1.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    .bulb::before {
      content: ''; position: absolute; inset: 6px;
      border-radius: 50%;
      background: radial-gradient(circle at 40% 40%, #fffbe6, #ffed9e);
      box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
    }
    .bulb-light {
      position: absolute; inset: 9px; border-radius: 50%;
      background: radial-gradient(circle, rgba(255,255,150,0.95), rgba(255,235,100,0.7), transparent 70%);
      opacity: 0;
      transition: opacity 1s ease;
    }
    .theme-toggle-input:checked + .theme-toggle-label .bulb-light { opacity: 1; }
    .bulb-glow {
      position: absolute; top: 50%; left: 50%;
      width: 70px; height: 70px;
      background: radial-gradient(circle, rgba(255,220,100,0.35), transparent 70%);
      border-radius: 50%;
      transform: translate(-50%,-50%);
      opacity: 0;
      transition: opacity 1s ease;
      pointer-events: none;
    }
    .theme-toggle-input:checked + .theme-toggle-label .bulb-glow { opacity: 1; }
    .rope.bottom {
      width: 2px; height: 22px;
      background: inherit;
      margin-top: -3px;
    }
    [data-theme="light"] .bulb {
      background: radial-gradient(circle at 30% 30%, #f0f0f0, #bbbbbb);
      border-color: rgba(0,0,0,0.25);
      box-shadow: 0 0 10px rgba(0,0,0,0.15), inset 0 0 8px rgba(0,0,0,0.1), 0 6px 12px rgba(0,0,0,0.2);
    }
    [data-theme="light"] .bulb::before {
      background: radial-gradient(circle at 40% 40%, #ffffff, #dddddd);
    }
    [data-theme="light"] .bulb-light,
    [data-theme="light"] .bulb-glow { opacity: 0 !important; }

    @media (max-width: 992px) { .theme-toggle-hanging { right: 5%; } }
    @media (max-width: 768px) { .theme-toggle-hanging { right: 20px; top: 80px; } header.scrolled ~ .theme-toggle-hanging { top: 70px; } }

    /* === Остальные стили страницы корзины (те, что были у тебя) === */
    main {
      padding: 140px 5% 10vh;
      display: grid;
      grid-template-columns: 1fr 440px;
      gap: 5rem;
      max-width: 1700px;
      margin: 0 auto;
      align-items: start;
    }
    @media (max-width: 1100px) { main { grid-template-columns: 1fr; } }

    .page-title { font-size: 7rem; font-weight: 100; letter-spacing: 16px; text-align: center; margin-bottom: 2rem; }
    #cartItemsList { display: flex; flex-direction: column; gap: 2rem; }
    .cart-item { display: flex; gap: 2rem; padding: 2rem; background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.1); border-radius: 24px; transition: all .3s; }
    .cart-item:hover { background: rgba(255,255,255,0.08); transform: translateY(-4px); }
    .cart-item img { width: 140px; height: 140px; object-fit: cover; border-radius: 16px; }
    .cart-item-title { font-size: 1.5rem; font-weight: 500; }
    .cart-item-price { font-size: 1.8rem; font-weight: 700; margin-top: 1rem; }
    .cart-empty { text-align: center; font-size: 1.6rem; color: #888; margin-top: 8rem; }

    .checkout-sidebar {
      position: sticky;
      top: 100px;
      background: rgba(20,20,20,0.96);
      backdrop-filter: blur(30px);
      border: 1.5px solid rgba(255,255,255,0.12);
      border-radius: 28px;
      padding: 2.5rem;
      box-shadow: 0 30px 80px rgba(0,0,0,0.4);
    }
    [data-theme="light"] .checkout-sidebar { background: rgba(255,255,255,0.96); box-shadow: 0 30px 80px rgba(0,0,0,0.1); }
    .checkout-title { font-size: 2.2rem; font-weight: 600; text-align: center; margin-bottom: 2rem; }
    .summary-row { display: flex; justify-content: space-between; padding: 1rem 0; font-size: 1.2rem; }
    .summary-row.total { font-size: 1.8rem; font-weight: 700; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.15); }
    .checkout-btn { width: 100%; margin: 2rem 0 1rem; padding: 1.4rem; background: white; color: black; border: none; border-radius: 18px; font-size: 1.3rem; font-weight: 600; cursor: pointer; }
    [data-theme="light"] .checkout-btn { background: black; color: white; }
    .archive-btn { width: 100%; padding: 0.9rem; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 16px; color: white; font-size: 0.95rem; cursor: pointer; }
    .archive-btn:hover { background: rgba(255,255,255,0.15); }

[data-theme="light"] .summary-row.total {
  border-top: 1px solid rgba(0,0,0,0.15) !important;
}

    .modal {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  overflow-y: auto;
}
.close-modal {
  position: absolute;
  top: 1rem; right: 1.5rem;
  background: none;
  border: none;
  font-size: 2rem;
  color: #aaa;
  cursor: pointer;
}
.close-modal:hover { color: #fff; }

#ordersList .empty-cart {
  text-align: center;
  padding: 3rem;
  font-size: 1.4rem;
  color: #888;
}

.archive-item {
  transition: all 0.3s;
}
.archive-item:hover {
  background: rgba(255,255,255,0.1) !important;
  transform: translateY(-2px);
}


        #orderChain .status-step { text-align:center; flex:1; position:relative; }
#orderChain .status-circle {
  width:70px; height:70px; margin:0 auto 1rem;
  background:#333; border:4px solid #444; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:1.8rem; color:#666; transition:all 0.5s;
}
#orderChain .status-step.active .status-circle {
  background:#00ff95; color:#000; border-color:#00ff95;
  box-shadow:0 0 30px rgba(0,255,149,0.6);
  transform:scale(1.15);
}
#orderChain .status-label { color:#aaa; font-size:1rem; transition:all 0.5s; }
#orderChain .status-step.active .status-label { color:#00ff95; font-weight:600; }
#orderChain .status-line {
  position:absolute; top:35px; left:15%; right:15%; height:4px;
  background:#333; z-index:-1; transition:all 0.8s;
}
#orderChain .status-step.active ~ .status-line,
#orderChain .status-step.active + .status-line + .status-step + .status-line { background:#00ff95; }

#orderChain .chain-img-circle.active {
  border-color: #00ff95 !important;
  box-shadow: 0 0 25px rgba(0,255,149,0.6) !important;
}
#orderChain .chain-img-circle.done {
  border-color: #00ff95 !important;
}
#orderChain .chain-loading {
  animation: pulse 2s infinite;
}
@keyframes pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}
#floatingOrderBar.show { display:block; animation:slideUp 0.6s cubic-bezier(0.32,0.72,0,1); }
#floatingOrderBar.hide { animation:slideDown 0.4s forwards; }

@keyframes slideUp {
  from { transform:translateX(-50%) translateY(100px); opacity:0; }
  to { transform:translateX(-50%) translateY(0); opacity:1; }
}
@keyframes slideDown {
  to { transform:translateX(-50%) translateY(100px); opacity:0; }
}

/* Увеличиваем иконки в развёрнутом виде */
#barExpanded .chain-img-circle { width:76px; height:76px; border-width:5px; }
#barExpanded .chain-img-circle.active { box-shadow:0 0 40px rgba(0,255,149,0.7); transform:scale(1.12); }

/* Apple-style плавность и скролл */
#ordersCarousel { 
  scrollbar-width: none; 
  -ms-overflow-style: none; 
}
#ordersCarousel::-webkit-scrollbar { display: none; }

/* Карточка одного заказа в карусели */
.order-card {
  min-width: 340px;
  max-width: 340px;
  background: rgba(255,255,255,0.06);
  border-radius: 24px;
  padding: 1.8rem 1.6rem;
  scroll-snap-align: center;
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 8px 32px rgba(0,0,0,0.2);
}

.order-card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1.5rem;
}

.order-card-id {
  font-size: 1.5rem;
  font-weight: 700;
  color: #fff;
}

.order-card-status {
  padding: 0.4rem 1rem;
  border-radius: 12px;
  font-size: 0.85rem;
  font-weight: 600;
  background: rgba(0,255,149,0.2);
  color: #00ff95;
}

/* Цепочка внутри карточки — уменьшенная версия */
.order-card .status-step { text-align:center; flex:1; position:relative; }
.order-card .status-circle {
  width:56px; height:56px; margin:0 auto 0.8rem;
  background:#333; border:3px solid #444; border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:1.5rem; color:#666; transition:all 0.5s;
}
.order-card .status-step.active .status-circle {
  background:#00ff95; color:#000; border-color:#00ff95;
  box-shadow:0 0 25px rgba(0,255,149,0.5);
  transform:scale(1.12);
}
.order-card .status-label { 
  color:#aaa; font-size:0.9rem; transition:all 0.5s; 
}
.order-card .status-step.active .status-label { 
  color:#00ff95; font-weight:600; 
}
.order-card .status-line {
  position:absolute; top:28px; left:12%; right:12%; height:3px;
  background:#333; z-index:-1; transition:all 0.8s;
}
.order-card .status-step.active ~ .status-line {
  background:#ffffff;
}

.pagination-btn {
    background: rgba(255,255,255,0.1);
    color: #fff;
    border: 1px solid rgba(255,255,255,0.15);
    width: 44px;
    height: 44px;
    border-radius: 50%;
    font-size: 1.1rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.pagination-btn:hover {
    background: #ffffff;
    color: #000;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3);
}

.pagination-btn:active {
    transform: translateY(0);
}


/* ФИКСЫ ДЛЯ СВЕТЛОЙ ТЕМЫ — 100% РАБОТАЕТ */

/* 1. Полоска под надписью "ТОВАРЫ" (и любые другие табы) */
[data-theme="light"] .tab-btn.active::after {
  background: linear-gradient(90deg, #0066ff, #00cc77) !important;
  height: 3px !important;
  opacity: 1 !important;
}

/* Если у тебя табы именно с классом .tab-btn — это гарантирует видимость полоски */
[data-theme="light"] .tab-btn.active {
  color: #000 !important;
}

/* 2. Кнопка "АРХИВ ЗАКАЗОВ" — чёрный текст + видимая рамка */
[data-theme="light"] .archive-btn {
  color: #000 !important;
  background: rgba(0,0,0,0.06) !important;
  border: 1.5px solid rgba(0,0,0,0.18) !important;
}

[data-theme="light"] .archive-btn:hover {
  background: rgba(0,0,0,0.12) !important;
  color: #000 !important;
}

/* 3. Любые другие кнопки типа "Повторить заказ", "Архив" и т.д. */
[data-theme="light"] .btn-primary,
[data-theme="light"] .orders-list .btn-primary {
  background: #000 !important;
  color: #fff !important;
}

[data-theme="light"] .btn-primary:hover,
[data-theme="light"] .orders-list .btn-primary:hover {
  background: #222 !important;
}

/* 4. Если где-то остались серые текста — принудительно чёрный */
[data-theme="light"] .chain-label,
[data-theme="light"] .mini-label,
[data-theme="light"] .archive-header p,
[data-theme="light"] .checkout-header p,
[data-theme="light"] .archive-empty,
[data-theme="light"] .tab-btn {
  color: #222 !important;
}

[data-theme="light"] .tab-btn:hover,
[data-theme="light"] .tab-btn.active {
  color: #000 !important;
}

/* 5. Иконки в светлой теме — чёрные */
[data-theme="light"] .archive-icon i,
[data-theme="light"] .checkout-icon i,
[data-theme="light"] .phone-premium i {
  color: #000 !important;
}

/* ФИНАЛЬНЫЙ ФИКС СВЕТЛОЙ ТЕМЫ — ТОВАРЫ, ПОЛОСКА, КНОПКИ */

[data-theme="light"] {
  /* 1. Нижняя полоска под активным табом "ТОВАРЫ", "УСЛУГИ" и т.д. */
  --tab-underline-color: linear-gradient(90deg, #0066ff, #00cc77);
}

/* Любой таб с классом .tab, .nav-link, .category-tab и т.п. */
[data-theme="light"] .tab.active::after,
[data-theme="light"] .nav-link.active::after,
[data-theme="light"] .category-tab.active::after,
[data-theme="light"] .tab-btn.active::after,
[data-theme="light"] [data-active="true"]::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--tab-underline-color);
  border-radius: 2px 2px 0 0;
  z-index: 10;
}

/* 2. Окантовка у карточек товаров */
[data-theme="light"] .product-card,
[data-theme="light"] .cart-item,
[data-theme="light"] .goods-card,
[data-theme="light"] .item-card {
  border: 1.8px solid rgba(0,0,0,0.15) !important;
  background: #fff !important;
  box-shadow: 0 8px 32px rgba(0,0,0,0.08);
}

/* ЕДИНЫЙ ЧЁРНЫЙ БЛОК КОЛИЧЕСТВА — СВЕТЛАЯ ТЕМА */
[data-theme="light"] .quantity-controls,
[data-theme="light"] .quantity-wrapper,
[data-theme="light"] .cart-item-quantity,
[data-theme="light"] .qty-control {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  background: #000 !important;
  color: #fff !important;
  border-radius: 16px !important;
  height: 48px !important;
  padding: 0 12px !important;
  gap: 20px !important;
  font-weight: 600 !important;
  font-size: 1.1rem !important;
}

/* Кнопки + и − внутри блока */
[data-theme="light"] .quantity-controls button,
[data-theme="light"] .qty-btn,
[data-theme="light"] [data-action="plus"],
[data-theme="light"] [data-action="minus"] {
  background: transparent !important;
  border: none !important;
  color: #fff !important;
  font-size: 1.4rem !important;
  width: 32px !important;
  height: 32px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  cursor: pointer !important;
  border-radius: 8px !important;
  transition: background 0.2s !important;
}

[data-theme="light"] .quantity-controls button:hover {
  background: rgba(255,255,255,0.15) !important;
}

  /* ПОЛНОСТЬЮ МОНОХРОМНЫЕ ТЕМЫ — БЕЗ ЦВЕТОВ */
html[data-theme="dark"] {
  /* Основной фон — тёмно-серый, но выглядит как почти чёрный (очень комфортно для глаз) */
  --pill-bg:            #0f0f14;
  --modal-bg:           #0f0f14;
  --modal-overlay:      rgba(10, 10, 15, 0.96);

  /* Границы — чисто белые, тонкие */
  --pill-border:        1px solid #ffffff;
  --modal-border:       1px solid rgba(255, 255, 255, 0.18);

  /* Тени — мягкие, но чёрные */
  --pill-shadow:        0 20px 50px rgba(0, 0, 0, 0.7);
  --modal-shadow:       0 50px 120px rgba(0, 0, 0, 0.8);

  /* ВСЁ остальное — чисто белое и чёрное, без серого */
  --icon-color:         #ffffff;
  --text-primary:       #ffffff;
  --text-secondary:     #ffffff;      /* был серый — теперь чисто белый */
  --badge-bg:           #ffffff;
  --badge-fg:           #000000;
  --grabber:            #ffffff;

  /* Кнопка "Закрыть" */
  --btn-bg:             #ffffff;
  --btn-fg:             #000000;
  --btn-hover:          #000000;
}

/* Ховер кнопки — инверсия */
html[data-theme="dark"] button[onclick="closeMultiOrderModal()"] {
  background: var(--btn-bg);
  color: var(--btn-fg);
}
html[data-theme="dark"] button[onclick="closeMultiOrderModal()"]:hover {
  background: var(--btn-hover) !important;
  color: #ffffff !important;
}

  html[data-theme="light"] {
    --pill-bg: #ffffff;
    --pill-border: rgba(0, 0, 0, 0.12);
    --pill-shadow: 0 20px 50px rgba(0, 0, 0, 0.14);
    --icon-color: #000000;
    --badge-bg: #000000;
    --badge-fg: #ffffff;
    --text-primary: #000000;
    --text-secondary: #666666;
    --modal-overlay: rgba(255, 255, 255, 0.92);
    --modal-bg: #ffffff;
    --modal-shadow: 0 50px 120px rgba(0, 0, 0, 0.16);
    --modal-border: rgba(0, 0, 0, 0.09);
    --grabber: rgba(0, 0, 0, 0.25);
    --btn-bg: #000000;
    --btn-fg: #ffffff;
    --btn-hover: #222222;
  }

@keyframes slideDown{from{transform:translateX(-50%) translateY(-80px);opacity:0}to{transform:translateX(-50%) translateY(0);opacity:1}}

.apple-cart-item{
  display:grid;grid-template-columns:88px 1fr auto 48px auto;grid-template-rows:auto auto;
  gap:14px 18px;align-items:center;padding:24px 22px;background:var(--cart-bg,#11111111);
  border:1px solid var(--cart-border,rgba(255,255,255,0.1));border-radius:26px;margin-bottom:16px;
  transition:all .4s cubic-bezier(.22,.61,.36,1);box-shadow:0 4px 20px rgba(0,0,0,0.08);
}
.apple-cart-item:hover{transform:translateY(-4px);box-shadow:0 20px 50px rgba(0,0,0,0.18);}
[data-theme="light"] .apple-cart-item{background:#ffffff;border:1px solid #e5e5e5;box-shadow:0 6px 25px rgba(0,0,0,0.07);}
[data-theme="light"] .apple-cart-item:hover{box-shadow:0 20px 50px rgba(0,0,0,0.14);}

.apple-cart-image img{width:88px;height:88px;border-radius:20px;object-fit:cover;background:#f2f2f7;}
.apple-cart-title{margin:0;font-size:1.24rem;font-weight:600;line-height:1.4;color:var(--text-primary,#fff);}
[data-theme="light"] .apple-cart-title{color:#000;}
.apple-cart-price{margin-top:6px;font-size:0.98rem;color:#999;}
[data-theme="light"] .apple-cart-price{color:#666;}

.apple-quantity-control{
  display:flex;align-items:center;gap:18px;background:var(--qty-bg,rgba(255,255,255,0.12));
  padding:11px 20px;border-radius:20px;font-weight:600;font-size:1.16rem;
}
[data-theme="light"] .apple-quantity-control{background:#f2f2f7;}

.apple-qty-btn{width:38px;height:38px;background:transparent;border:none;color:var(--text-secondary,#aaa);
  border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .25s;}
.apple-qty-btn:hover{background:var(--qty-hover,rgba(255,255,255,0.25));transform:scale(1.15);}
[data-theme="light"] .apple-qty-btn:hover{background:#e5e5e5;}
.apple-qty-btn:disabled{opacity:0.3;cursor:not-allowed;transform:none!important;}

.apple-remove-btn{width:50px;height:50px;background:rgba(255,59,48,0.18);color:#ff453a;
  border:none;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .25s;}
.apple-remove-btn:hover{background:rgba(255,59,48,0.4);transform:scale(1.18);}
[data-theme="light"] .apple-remove-btn{background:rgba(255,59,48,0.12);}
[data-theme="light"] .apple-remove-btn:hover{background:rgba(255,59,48,0.28);}

.apple-cart-total{font-size:1.55rem;font-weight:700;color:#00ff95;text-align:right;}
[data-theme="light"] .apple-cart-total{color:#00d26a;}

.cart-empty-apple{text-align:center;padding:6rem 2rem;color:#888;}
.cart-empty-apple i{font-size:5rem;opacity:0.2;margin-bottom:1.8rem;display:block;}
.empty-title{font-size:1.6rem;font-weight:600;margin:1rem 0;}
.empty-subtitle{font-size:1.15rem;color:#888;}

@media (max-width:768px){
  .apple-cart-item{grid-template-columns:76px 1fr auto;grid-template-rows:auto auto auto;gap:12px;padding:18px;}
  .apple-quantity-control{grid-column:3;grid-row:2;}
  .apple-remove-btn{grid-column:1;grid-row:3;margin-top:10px;}
  .apple-cart-total{grid-column:2/4;grid-row:3;text-align:right;font-size:1.45rem;}
}
/* УБИЙЦА ВСЕХ ЛЕВЫХ ШТОРОК 2025 */
#mobileFeedbackSheet,
.mobile-feedback-sheet {
  position: fixed !important;
  top: auto !important;
  bottom: 0 !important;
  left: 0 !important;
  right: 0 !important;
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  max-height: 96vh !important;
  border-radius: 28px 28px 0 0 !important;
  transform: translateY(120%) !important;
  transition: transform 0.58s cubic-bezier(0.22, 0.61, 0.36, 1) !important;
  box-shadow: 0 -20px 80px rgba(0,0,0,0.5) !important;
  z-index: 9999 !important;
  overflow-y: auto !important;
  overflow-x: hidden !important;
}

#mobileFeedbackSheet.active,
.mobile-feedback-sheet.active {
  transform: translateY(0) !important;
}

/* На всякий случай — убиваем старые анимации */
.mobile-feedback-sheet * {
  transform: none !important;
}
/* #floatingOrderBar — переезжает НАВЕРХ на всех телефонах */
@media (max-width: 1026px) {
  #floatingOrderBar {
    top: max(env(safe-area-inset-top), 12px) !important;
    bottom: auto !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    border-radius: 0 0 20px 20px !important;
    width: calc(100% - 32px) !important;
    max-width: 420px !important;
    box-shadow: 0 12px 40px rgba(0,0,0,0.4) !important;
    animation: slideDownFromTopBar 0.5s cubic-bezier(0.22,1,0.36,1) !important;
    z-index: 1 !important;
  }

  /* Если у тебя есть состояние .show / .hide — тоже поправим */
  #floatingOrderBar.show {
    transform: translateX(-50%) translateY(0) !important;
  }

  #floatingOrderBar.hide {
    transform: translateX(-50%) translateY(-120%) !important;
  }
}

@keyframes slideDownFromTopBar {
  from { transform: translateX(-50%) translateY(-120%); opacity: 0; }
  to   { transform: translateX(-50%) translateY(0);     opacity: 1; }
}

@media (max-width: 768px) {

  /* Шторка сверху — НО НЕ ПЕРЕКРЫВАЕТ НИЖНИЕ ЭЛЕМЕНТЫ */
  #orderChain {
    position: fixed !important;
    top: 0; left: 0; right: 0;
    width: 100% !important;
    /* Главное: ограничиваем высоту, чтобы не лезть под нижние сайдбары */
    max-height: calc(100dvh - 120px) !important; /* 120px — примерная высота нижних элементов */
    background: rgba(15,15,25,0.98) !important;
    backdrop-filter: blur(40px);
    border-radius: 0 0 28px 28px !important;
    padding: 0 !important;
    overflow-y: auto !important;
    overscroll-behavior: contain !important;
    /* z-index ниже, чем у нижних фиксированных элементов */
    z-index: 900 !important; /* вместо 99999 */
    transform: translateY(-100%);
    transition: transform 0.58s cubic-bezier(0.22,1,0.36,1) !important;
    box-shadow: 0 20px 40px rgba(0,0,0,0.6);
  }

  #orderChain.show {
    transform: translateY(0) !important;
  }

  /* Шапка шторки — sticky, чтобы не уезжала */
  #orderChain::before {
    content: '';
    position: sticky;
    top: 0;
    left: 0; right: 0;
    height: calc(env(safe-area-inset-top) + 64px);
    background: rgba(15,15,25,0.95);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(255,255,255,0.08);
    z-index: 10;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: env(safe-area-inset-top) 20px 0;
  }

  /* Кнопки в шапке */
  #orderChain::after { /* Свернуть ↑ */
    content: '↑';
    position: absolute;
    top: calc(env(safe-area-inset-top) + 12px);
    left: 20px;
    width: 48px; height: 48px;
    background: rgba(255,255,255,0.15);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    color: #fff;
    backdrop-filter: blur(10px);
    z-index: 11;
  }

  #orderChain > .close-btn { /* Закрыть × */
    position: absolute !important;
    top: calc(env(safe-area-inset-top) + 12px) !important;
    right: 20px !important;
    width: 48px !important; height: 48px !important;
    background: rgba(255,255,255,0.15) !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 28px !important;
    color: #fff !important;
    backdrop-filter: blur(10px) !important;
    z-index: 11 !important;
  }

  /* Контент — отступ под шапку */
  #orderChain > div {
    padding: calc(env(safe-area-inset-top) + 80px) 20px 40px !important;
  }

  /* Остальные стили (цепочка, товары) — оставляем как есть */
  #orderChain > div > div[style*="flex-wrap"] {
    flex-direction: column !important;
    gap: 32px !important;
    align-items: center !important;
  }

  #orderChain .chain-img-circle {
    width: 80px !important;
    height: 80px !important;
    border-width: 5px !important;
  }

  /* Вертикальные линии */
  #orderChain div[style*="position:absolute;top:30px"],
  #orderChain div[style*="position:absolute"][style*="left:70px"] {
    width: 5px !important;
    height: 60px !important;
    left: 50% !important;
    top: 90px !important;
    transform: translateX(-50%) !important;
    background: #444 !important;
  }
  #orderChain div[style*="background:#00ff95"] {
    background: #00ff95 !important;
    box-shadow: 0 0 20px rgba(0,255,149,0.6) !important;
  }
}

@media (max-width: 1026px) {
  .desktop-cart-left,
  .checkout-sidebar.desktop-only {
    display: none !important;
  }
  .mobile-cart-layout { display: block !important; }

  /* Подняли весь контент выше — не лезет под шторку заказов */
  .mobile-cart-layout {
    padding-top: 130px !important;    /* +30px от прошлого */
    padding-bottom: 200px !important;
  }

  .mobile-cart-header { margin-bottom: 40px; }

  .page-title {
    font-size: 36px;
    letter-spacing: -1.2px;
  }

  .archive-btn-mobile {
    width: 52px; height: 52px;
    background: rgba(255,255,255,0.14);
    border: none; border-radius: 18px;
    color: #fff; font-size: 22px;
  }
  [data-theme="light"] .archive-btn-mobile {
    background: rgba(0,0,0,0.1); color: #000;
  }

  .mobile-summary-minimal { margin: 56px 0 90px; }


  [data-theme="light"] .divider-line { background: rgba(0,0,0,0.2); }

  .summary-row { font-size: 19px; padding: 12px 0; }
  .summary-row.total { font-size: 24px; font-weight: 700; }

  /* КНОПКА ЕЩЁ ВЫШЕ — не лезет под нижнюю навигацию */
  .checkout-btn-fixed {
    position: fixed;
    left: 20px; right: 20px;
    bottom: calc(env(safe-area-inset-bottom, 20px) + 110px); /* +10px выше */
    z-index: 998;
    padding: 20px;
    background: #fff; color: #000;
    border: none; border-radius: 20px;
    font-size: 19px; font-weight: 700;
    box-shadow: 0 15px 50px rgba(0,0,0,0.4);
  }
  [data-theme="light"] .checkout-btn-fixed { background: #000; color: #fff; }
}

@media (min-width: 1027px) {
  .mobile-cart-layout { display: none !important; }
  .cart-items-mobile { display: none !important; }
}

@media (max-width: 1026px) {
  .mobile-cart-layout {
    display: block !important;
    padding: 130px 20px 220px !important; /* сверху — под шторку заказов, снизу — под кнопку */
    min-height: 100vh;
    box-sizing: border-box;
  }

  /* Товары — занимают всё доступное место и скроллятся */
  .cart-items-mobile {
    margin-bottom: 32px;
  }

  /* Итого — фиксируем отступы */
  .mobile-summary-minimal {
    margin: 48px 0 100px;
  }

  .checkout-btn-fixed {
    bottom: calc(env(safe-area-inset-bottom, 20px) + 100px);
  }
}
@media (max-width: 1026px) {
  .mobile-cart-layout {
    padding: 130px 20px 220px !important;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  /* Итого — фиксированная высота, всегда сверху после заголовка */
  .mobile-summary-minimal {
    margin: 20px 0 40px 0; /* отступ снизу — чтобы товары не прилипали */
    flex-shrink: 0;
  }

  /* Товары — занимают всё оставшееся место и скроллятся */
  .cart-items-mobile {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 20px;
  }

  /* Чтобы при пустой корзине тоже было красиво */
  .cart-items-mobile:empty + .checkout-btn-fixed,
  .cart-items-mobile .cart-empty-apple {
    margin-top: 40px;
  }
}
#archiveModal {
    overscroll-behavior: contain; /* важно для iOS */
}

#archiveModal .smart-sheet,
#archiveModal .archive-content {
    max-height: 92vh;
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 100px;
    
    /* ——— ПОЛНОСТЬЮ СКРЫВАЕМ ПОЛОСУ ПРОКРУТКИ ——— */
    scrollbar-width: none;           /* Firefox */
    -ms-overflow-style: none;        /* IE и Edge */
}

/* Chrome, Safari, новый Edge */
#archiveModal .smart-sheet::-webkit-scrollbar,
#archiveModal .archive-content::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
}

/* На всякий случай — если полоса всё-таки пытается появиться */
#archiveModal::-webkit-scrollbar,
#archiveModal *::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
}
@media (max-width: 1026px) {
  .mobile-remove-btn {
    position: absolute !important;
    top: 12px;
    right: 12px;
    opacity: 1 !important;
    z-index: 10;
    width: 44px;
    height: 44px;
    background: rgba(255, 59, 48, 0.18);     /* лёгкий красный фон */
    backdrop-filter: blur(12px);
    border: none;
    border-radius: 16px;
    color: #ff3b30;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(255, 59, 48, 0.25);
    transition: all 0.3s cubic-bezier(0.22, 1, 0.36, 1);
  }

  [data-theme="light"] .mobile-remove-btn {
    background: rgba(255, 59, 48, 0.12);
    box-shadow: 0 4px 12px rgba(255, 59, 48, 0.18);
  }

  /* При нажатии — лёгкая анимация */
  .mobile-remove-btn:active {
    transform: scale(0.92);
    background: rgba(255, 59, 48, 0.35) !important;
  }

  /* Чтобы контент не залезал под кнопку */
  .mobile-cart-item {
    position: relative;
    padding-right: 60px;   /* место под кнопку */
    padding-top: 8px;
  }

  .mobile-cart-main {
    padding-right: 8px;
  }
}
@media (max-width: 1026px) {
  .mobile-cart-item {
    position: relative;
    display: flex;
    align-items: flex-start;
    gap: 16px;
    padding: 20px 0;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  [data-theme="light"] .mobile-cart-item { border-color: rgba(0,0,0,0,0.08); }

  .mobile-cart-image {
    width: 96px;
    height: 96px;
    border-radius: 16px;
    overflow: hidden;
    flex-shrink: 0;
  }
  .mobile-cart-image img { width: 100%; height: 100%; object-fit: cover; }

  .mobile-cart-main {
    flex: 1;
    min-width: 0;
    padding-top: 4px;
  }

  .mobile-cart-title {
    font-size: 17px;
    font-weight: 600;
    margin: 0 0 12px 0;
    line-height: 1.35;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .mobile-cart-bottom {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 16px;
    flex-wrap: wrap;
  }

  .mobile-cart-price {
    font-size: 15px;
    color: #aaa;
    white-space: nowrap;
  }

  .mobile-quantity-control {
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.1);
    border-radius: 12px;
    padding: 4px;
    gap: 8px;
  }
  [data-theme="light"] .mobile-quantity-control { background: rgba(0,0,0,0.08); }

  .qty-btn {
    width: 36px;
    height: 36px;
    border: none;
    background: transparent;
    color: currentColor;
    font-size: 20px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .qty-btn:active:not(:disabled) { background: rgba(255,255,255,0.2); }

  .qty-value {
    min-width: 36px;
    text-align: center;
    font-weight: 600;
    font-size: 17px;
  }

  .mobile-cart-total-price {
    margin-left: auto;
    font-size: 19px;
    font-weight: 700;
    white-space: nowrap;
  }

  /* КОРЗИНА — ПРАВЫЙ ВЕРХНИЙ УГОЛ */
  .mobile-remove-btn {
    position: absolute;
    top: 16px;
    right: 0;
    width: 44px;
    height: 44px;
    background: rgba(255,59,48,0.18);
    border: none;
    border-radius: 14px;
    color: #ff3b30;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
  }
  [data-theme="light"] .mobile-remove-btn {
    background: rgba(255,59,48,0.12);
  }
  .mobile-remove-btn:active {
    background: rgba(255,59,48,0.4);
    transform: scale(0.9);
  }
}

@media (max-width: 1026px) {
  .mobile-cart-item {
    position: relative;
    display: flex;
    gap: 14px;
    padding: 18px 56px 18px 12px;   /* 56px справа — под кнопку */
    border-bottom: 1px solid rgba(255,255,255,0.09);
    min-height: 110px;
  }
  [data-theme="light"] .mobile-cart-item {
    border-bottom-color: rgba(0,0,0,0.07);
  }

  .mobile-cart-image {
    width: 80px;
    height: 80px;
    border-radius: 14px;
    overflow: hidden;
    flex-shrink: 0;
  }
  .mobile-cart-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .mobile-cart-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }

  .mobile-cart-title {
    font-size: 16px;
    font-weight: 600;
    line-height: 1.35;
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .mobile-cart-footer {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 8px;
    font-size: 15px;
  }

  .mobile-cart-price {
    color: #aaa;
    white-space: nowrap;
  }

  .mobile-quantity-control {
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.11);
    border-radius: 12px;
    padding: 3px 6px;
    gap: 6px;
    flex-shrink: 0;
  }
  [data-theme="light"] .mobile-quantity-control {
    background: rgba(0,0,0,0.08);
  }

  .apple-qty-btn {
    width: 34px;
    height: 34px;
    background: transparent;
    border: none;
    color: currentColor;
    font-size: 19px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .apple-qty-btn:active:not(:disabled) {
    background: rgba(255,255,255,0.2);
  }

  .apple-qty-value {
    min-width: 32px;
    text-align: center;
    font-weight: 600;
    font-size: 16px;
  }

  .mobile-cart-total-price {
    margin-left: auto;
    font-size: 18px;
    font-weight: 700;
    white-space: nowrap;
    padding-left: 8px;
  }

  /* МУСОРКА — В САМОМ ПРАВОМ ВЕРХНЕМ УГЛУ! */
  .mobile-remove-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    width: 40px;
    height: 40px;
    background: rgba(255,59,48,0.18);
    border: none;
    border-radius: 14px;
    color: #ff3b30;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
  }
  [data-theme="light"] .mobile-remove-btn {
    background: rgba(255,59,48,0.12);
  }
  .mobile-remove-btn:active {
    transform: scale(0.9);
    background: rgba(255,59,48,0.4);
  }
}

.smart-archive {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 99999;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(28px);
  -webkit-backdrop-filter: blur(28px);
  font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
  align-items: center;
  justify-content: center;
  padding: 20px;
  overflow: hidden;
}

/* Шторка */
.smart-sheet {
  background: rgba(255,255,255,0.96);
  backdrop-filter: blur(32px);
  -webkit-backdrop-filter: blur(32px);
  border-radius: 24px;
  width: 100%;
  max-width: 920px;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  animation: appear 0.4s cubic-bezier(0.22,0.61,0.36,1);
}

/* Граббер */
.grabber {
  width: 36px;
  height: 5px;
  background: rgba(0,0,0,0.28);
  border-radius: 3px;
  margin: 11px auto 6px;
  flex-shrink: 0;
}

/* Крестик на ПК */
.close-btn {
  position: absolute;
  top: 16px;
  right: 16px;
  width: 40px;
  height: 40px;
  background: rgba(0,0,0,0.09);
  border: none;
  border-radius: 50%;
  font-size: 22px;
  color: #fff;
  cursor: pointer;
}
.close-btn:hover { background: rgba(0,0,0,0.16); }

/* Заголовок */
.smart-title {
  text-align: center;
  font-size: 21px;
  font-weight: 700;
  margin: 8px 0 10px;
  color: #000;
}

/* Вкладки — ЧИСТО ЧЁРНО-БЕЛЫЕ */
.smart-tabs {
  display: flex;
  padding: 0 20px 14px;
  gap: 32px;
  overflow-x: auto;
  scrollbar-width: none;
  -webkit-overflow-scrolling: touch;
}
.smart-tabs::-webkit-scrollbar { display: none; }

.tab-btn {
  padding: 8px 0;
  font-size: 17px;
  font-weight: 600;
  color: #666;
  background: none;
  border: none;
  position: relative;
  white-space: nowrap;
}
.tab-btn.active {
  color: #000;
}
.tab-btn.active::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0; right: 0;
  height: 2.5px;
  background: #000;        /* ЧЁРНАЯ ПОЛОСКА */
  border-radius: 2px;
}
.tab-btn span {
  background: #000;        /* ЧЁРНЫЙ БЭЙДЖ */
  color: white;
  font-size: 11px;
  padding: 3px 7px;
  border-radius: 9px;
  margin-left: 6px;
  font-weight: 600;
}

/* Поиск */
.smart-search {
  margin: 0 20px 16px;
  position: relative;
}
.smart-search i { 
  position: absolute; 
  left: 14px; 
  top: 50%; 
  transform: translateY(-50%); 
  color: #888; 
  font-size: 17px;
}
#orderSearch {
  width: 100%;
  padding: 13px 16px 13px 46px;
  background: rgba(0,0,0,0.08);
  border: none;
  border-radius: 12px;
  font-size: 17px;
  color: #000;
}
#orderSearch::placeholder { color: #888; }

/* Список — ПОЛНАЯ ВЫСОТА + СКРЫТЫЙ СКРОЛЛБАР */
.smart-list {
  flex: 1;
  overflow-y: auto;
  padding: 0 20px 40px;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;           /* Firefox */
}
.smart-list::-webkit-scrollbar {   /* Chrome/Safari */
  display: none;
  width: 0;
  background: transparent;
}

/* Кнопка "ещё" */
.smart-more {
  padding: 0 20px 32px;
  text-align: center;
}
.smart-more button {
  color: #000;
  font-size: 17px;
  font-weight: 600;
  background: none;
  border: none;
  padding: 12px;
  cursor: pointer;
  opacity: 0.8;
}

/* Пустое состояние */
.smart-empty {
  text-align: center;
  padding: 90px 30px;
  color: #888;
  display: none;
  flex: 1;
}
.smart-empty h3 {
  font-size: 22px;
  font-weight: 600;
  color: #000;
  margin: 16px 0 8px;
}

/* МОБИЛЬНАЯ ВЕРСИЯ — 100% ВЫСОТА ЭКРАНА */
@media (max-width: 768px) {
  .smart-archive {
    align-items: flex-end;
    padding: 0;
  }

  .smart-sheet {
    border-radius: 24px 24px 0 0;
    width: 100%;
    max-width: none;
    height: auto;
    min-height: 50vh;
    max-height: 92dvh;           /* ← ВОТ ЭТО ПРАВИЛЬНО */
    /* Убираем фиксированную высоту! */
    transform: translateY(100%); /* изначально скрыт */
    transition: transform 0.45s cubic-bezier(0.22, 0.61, 0.36, 1);
  }

  /* При открытии — плавно выдвигается */
  #archiveModal.show .smart-sheet {
    transform: translateY(0);
  }
}

/* Десктоп */
@media (min-width: 769px) {
  .grabber { display: none; }
  .smart-sheet {
    height: auto;
    max-height: 92vh;
  }
}

/* Тёмная тема — тоже только чёрный и белый */
html[data-theme="dark"] .smart-sheet { background: rgba(28,28,30,0.98); }
html[data-theme="dark"] .smart-title,
html[data-theme="dark"] .tab-btn.active,
html[data-theme="dark"] .smart-empty h3 { color: #fff; }
html[data-theme="dark"] #orderSearch { background: rgba(255,255,255,0.1); color: #fff; }
html[data-theme="dark"] .grabber { background: rgba(255,255,255,0.3); }
html[data-theme="dark"] .tab-btn.active::after,
html[data-theme="dark"] .tab-btn span { background: #fff; color: #000; }

/* Анимации */
@keyframes appear { from { opacity: 0; transform: scale(0.94); } to { opacity: 1; transform: scale(1); } }
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
/* Apple-минимализм 2025 для архива заказов */
.apple-archive-order {
    background: rgba(255,255,255,0.97);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 14px;
    border: 1px solid rgba(0,0,0,0.07);
    transition: all 0.35s cubic-bezier(0.22,0.61,0.36,1);
    cursor: pointer;
}
.apple-archive-order:hover {
    box-shadow: 0 10px 30px rgba(0,0,0,0.12);
    transform: translateY(-3px);
}

.archive-order-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 18px;
    gap: 12px;
}
.archive-order-title {
    font-size: 18px;
    font-weight: 700;
    color: #000;
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
}
.archive-status-badge {
    font-size: 14px;
    font-weight: 500;
    color: #666;
    background: rgba(0,0,0,0.06);
    padding: 4px 10px;
    border-radius: 10px;
}
.archive-order-meta {
    text-align: right;
}
.archive-order-date {
    font-size: 13.5px;
    color: #888;
    margin-bottom: 4px;
}
.archive-order-total {
    font-size: 18px;
    font-weight: 700;
    color: #000;
}

.archive-items-list { margin: 16px 0; display: flex; flex-direction: column; gap: 12px; }
.archive-item-row { display: flex; align-items: center; gap: 14px; }
.archive-item-thumb {
    width: 52px; height: 52px; border-radius: 12px; object-fit: cover;
    background: #f2f2f7; flex-shrink: 0;
}
.archive-item-info { flex: 1; min-width: 0; }
.archive-item-name {
    font-size: 15px; font-weight: 600; color: #000;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.archive-item-details { font-size: 13.5px; color: #888; margin-top: 2px; }

.archive-repeat-btn {
    padding: 9px 16px;
    background: #000;
    color: #fff;
    border: none;
    border-radius: 12px;
    font-size: 13.5px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.2s;
}
.archive-repeat-btn:hover { background: #333; }

.archive-more-items {
    text-align: center;
    color: #888;
    font-size: 14.5px;
    padding: 10px 0;
}

.archive-cancel-reason {
    margin-top: 18px;
    padding: 14px;
    background: rgba(255,68,68,0.05);
    border-radius: 14px;
    border: 1px solid rgba(255,68,68,0.15);
}
.cancel-reason-title {
    font-size: 13.5px;
    font-weight: 600;
    color: #ff3333;
    margin-bottom: 5px;
}
.cancel-reason-text {
    font-size: 14.5px;
    color: #ff5555;
    line-height: 1.5;
}

.archive-progress-chain {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 20px;
    padding-top: 16px;
    border-top: 1px solid rgba(0,0,0,0.08);
}
.progress-dot {
    width: 9px; height: 9px;
    background: #ddd;
    border-radius: 50%;
    transition: all 0.3s;
}
.progress-dot.filled { background: #000; }
.progress-line {
    flex: 1;
    height: 2px;
    background: #ddd;
    margin: 0 4px;
    transition: all 0.3s;
}
.progress-line.filled { background: #000; }

/* Тёмная тема */
html[data-theme="dark"] .apple-archive-order {
    background: rgba(28,28,30,0.97);
    border-color: rgba(255,255,255,0.1);
}
html[data-theme="dark"] .archive-order-title,
html[data-theme="dark"] .archive-item-name,
html[data-theme="dark"] .archive-order-total { color: #fff; }
html[data-theme="dark"] .archive-status-badge { background: rgba(255,255,255,0.1); color: #aaa; }
html[data-theme="dark"] .archive-item-details,
html[data-theme="dark"] .archive-order-date { color: #aaa; }
html[data-theme="dark"] .archive-repeat-btn { background: #fff; color: #000; }
html[data-theme="dark"] .progress-dot { background: #555; }
html[data-theme="dark"] .progress-dot.filled,
html[data-theme="dark"] .progress-line.filled { background: #fff; }
/* 5 точек прогресса — чисто, как у Apple */
.archive-progress-chain {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 20px 0 8px;
    position: relative;
}
.progress-step {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}
.progress-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #ddd;
    transition: all 0.4s cubic-bezier(0.22,0.61,0.36,1);
    z-index: 2;
}
.progress-step.filled .progress-dot {
    background: #000;
    transform: scale(1.2);
}
.progress-line {
    position: absolute;
    top: 50%;
    left: 50%;
    right: -50%;
    height: 2px;
    background: #ddd;
    transform: translateY(-50%);
    transition: background 0.4s;
    z-index: 1;
}
.progress-step.filled ~ .progress-step .progress-line {
    background: #000;
}

/* Подписи под точками */
.progress-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 8px;
    font-size: 12px;
    color: #888;
}
.progress-label {
    flex: 1;
    text-align: center;
    transition: all 0.3s;
}
.progress-label.filled {
    color: #000;
    font-weight: 600;
}

/* Финальные иконки */
.archive-final-status {
    text-align: center;
    margin: 20px 0;
    font-size: 48px;
    font-weight: 200;
}
.final-icon.completed { color: #000; }
.final-icon.cancelled { color: #ff3333; }

/* Тёмная тема */
html[data-theme="dark"] .progress-dot { background: #555; }
html[data-theme="dark"] .progress-step.filled .progress-dot { background: #fff; }
html[data-theme="dark"] .progress-line { background: #555; }
html[data-theme="dark"] .progress-step.filled ~ .progress-step .progress-line { background: #fff; }
html[data-theme="dark"] .progress-label { color: #aaa; }
html[data-theme="dark"] .progress-label.filled { color: #fff; }

/* ==================================================
   МОБИЛЬНАЯ КОРЗИНА 2025 — ИТОГО ПОД ШТОРКОЙ ЗАКАЗОВ
   (≤1026px)
================================================== */
@media (max-width: 1026px) {
  /* Главный контейнер — теперь flex-column с правильным порядком */
  .mobile-cart-layout {
    display: flex !important;
    flex-direction: column;
    min-height: 100dvh;
    padding: 0 20px 140px !important; /* снизу место под кнопку оформления */
    padding-top: 20px !important;     /* отступ после шторки заказов */
    gap: 0;
  }


  /* Заголовок "Корзина" внутри итогов (если есть) */
  .mobile-summary-minimal .checkout-title,
  .mobile-summary-minimal h3 {
    font-size: 22px;
    text-align: center;
    margin-bottom: 20px;
  }

  /* 3. Потом — список товаров (занимает всё оставшееся место) */
  .cart-items-mobile {
    order: 2;
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 20px;
  }

  /* Если у тебя пустая корзина — тоже всё красиво */
  .cart-empty-apple {
    order: 2;
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    text-align: center;
    padding: 60px 20px;
  }
}

/* === ФИНАЛЬНЫЙ РАБОЧИЙ ВАРИАНТ — ДЛЯ ТЕЛЕФОНОВ ≤1026px === */
@media (max-width: 1026px) {
  .mobile-cart-layout {
    display: flex !important;
    flex-direction: column;
    min-height: 100dvh;
    padding-left: 20px !important;
    padding-right: 20px !important;
    padding-bottom: 140px !important;     /* место под кнопку оформления */
    box-sizing: border-box;

    /* ←←← ВОТ ЭТО ГЛАВНОЕ — динамический отступ сверху */
    padding-top: 20px !important;         /* по умолчанию — плашки нет */
    transition: padding-top 0.42s cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Когда есть активные заказы — отодвигаем контент под плашку */
  body.has-active-orders .mobile-cart-layout {
    padding-top: 92px !important;         /* 80–85 высота плашки + safe-area + тень */
  }

  /* Чтобы всё красиво скроллилось */
  .cart-items-mobile,
  .cart-empty-apple {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}
/* А если хочешь быть на 1000% уверен — вот так: */
#floatingOrderBar {
  z-index: 1000 !important;   /* АБСОЛЮТНЫЙ МАКСИМУМ */
}

/* ===================================================== */
/*       МОДАЛКА ОТЗЫВОВ — УНИВЕРСАЛЬНАЯ 2025 (ПК + МОБИЛКА)       */
/* ===================================================== */

#reviewModal {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 99999;
  padding: 1.5rem;
  background: rgba(0, 0, 0, 0.92);
  backdrop-filter: blur(28px);
  -webkit-backdrop-filter: blur(28px);
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.4s ease;
}

.review-modal-apple {
  background: #000000;                          /* ЧИСТЫЙ ЧЁРНЫЙ везде */
  border: 1px solid rgba(255, 255, 255, 0.09);
  border-radius: 28px;
  width: 100%;
  max-width: 460px;
  margin: 0 auto;
  padding: 2.4rem 2rem 2rem;
  box-shadow: 0 32px 90px rgba(0, 0, 0, 0.75);
  position: relative;
  animation: modalUp 0.55s cubic-bezier(0.22, 1, 0.36, 1);
}

.close-modal {
  position: absolute;
  top: 1.2rem;
  right: 1.4rem;
  background: none;
  border: none;
  font-size: 2.2rem;
  color: #888;
  cursor: pointer;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.3s;
}
.close-modal:hover { background: rgba(255,255,255,0.1); color: #fff; }

.review-header-apple h2 {
  font-size: 1.85rem;
  font-weight: 800;
  margin: 0 0 0.6rem;
  text-align: center;
  color: #fff;
}

.review-header-apple p {
  font-size: 1.22rem;
  text-align: center;
  color: #ccc;
  margin: 0 0 1.8rem;
  line-height: 1.45;
  word-break: break-word;
  hyphens: auto;
}

.review-stars-apple {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin: 1.6rem 0 2rem;
}

.review-stars-apple i {
  font-size: 2.6rem;         
  width: 52px;
  height: 52px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #444;
  transition: all 0.3s ease;
  cursor: pointer;
}

.review-stars-apple i.fas {
  color: #ffd700;
  filter: drop-shadow(0 4px 12px rgba(255, 215, 0, 0.5));
  transform: scale(1.12);
}

.review-textarea-apple {
  width: 100%;
  min-height: 108px;
  background: rgba(255, 255, 255, 0.07);
  border: 1.5px solid rgba(255, 255, 255, 0.14);
  border-radius: 18px;
  padding: 1.1rem 1.3rem;
  color: #fff;
  font-size: 1.05rem;
  font-family: inherit;
  resize: none;
  margin-bottom: 1.8rem;
}
.review-textarea-apple::placeholder { color: #777; }

.review-buttons-apple {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.review-btn-primary,
.review-btn-secondary {
  padding: 1.15rem;
  border-radius: 20px;
  font-size: 1.1rem;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.3s;
}

.review-btn-primary {
  background: #00ff95;
  color: #000;
  border: none;
  box-shadow: 0 8px 25px rgba(0, 255, 149, 0.4);
}
.review-btn-primary:hover { background: #00ffaa; transform: translateY(-2px); }

.review-btn-secondary {
  background: rgba(255, 255, 255, 0.09);
  color: #fff;
  border: 1.5px solid rgba(255,255,255,0.18);
}
.review-btn-secondary:hover { background: rgba(255,255,255,0.15); }

/* АДАПТИВ: МОБИЛКА ≤1026px — чуть компактнее и удобнее */
@media (max-width: 1026px) {
  #reviewModal { padding: 1rem; }
  .review-modal-apple {
    max-width: 94%;
    padding: 2.2rem 1.8rem 2rem;
    border-radius: 26px;
  }
  .review-header-apple h2 { font-size: 1.75rem; }
  .review-header-apple p { font-size: 1.18rem; }
  .review-stars-apple i { font-size: 2.5rem; width: 48px; height: 48px; }
  .review-textarea-apple { min-height: 100px; font-size: 1.02rem; }
}

/* СВЕТЛАЯ ТЕМА — полная поддержка */
[data-theme="light"] #reviewModal {
  background: rgba(255, 255, 255, 0.92);
}
[data-theme="light"] .review-modal-apple {
  background: #ffffff;
  border-color: rgba(0,0,0,0.1);
  box-shadow: 0 32px 90px rgba(0,0,0,0.18);
}
[data-theme="light"] .review-header-apple h2 { color: #111; }
[data-theme="light"] .review-header-apple p { color: #555; }
[data-theme="light"] .review-textarea-apple {
  background: rgba(0,0,0,0.06);
  border-color: rgba(0,0,0,0.15);
  color: #000;
}
[data-theme="light"] .review-btn-secondary {
  background: rgba(0,0,0,0.08);
  border-color: rgba(0,0,0,0.15);
  color: #000;
}
[data-theme="light"] .close-modal { color: #666; }
[data-theme="light"] .close-modal:hover { background: rgba(0,0,0,0.1); color: #000; }

/* Анимации */
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes modalUp {
  from { transform: translateY(80px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}